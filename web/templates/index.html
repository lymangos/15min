<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>15分钟生活圈分析系统</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
    
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="app-container">
        <!-- 侧边栏 -->
        <aside class="sidebar">
            <header class="sidebar-header">
                <h1>🏘️ 15分钟生活圈</h1>
                <p class="subtitle">城市服务可达性分析系统</p>
            </header>

            <div class="sidebar-content">
                <!-- 地址搜索 -->
                <section class="panel" id="search-panel">
                    <h3>🔍 地址搜索</h3>
                    <div class="search-container">
                        <input type="text" id="search-input" placeholder="输入地址或POI名称..." autocomplete="off">
                        <button id="search-btn" class="search-btn" title="搜索">🔍</button>
                        <button id="locate-btn" class="locate-btn" title="定位到当前位置">📍</button>
                    </div>
                    <div id="search-results" class="search-results" style="display: none;"></div>
                </section>

                <!-- 当前坐标 -->
                <section class="panel">
                    <h3>📌 当前位置</h3>
                    <div id="current-location">
                        <p class="placeholder">请在地图上点击选择位置</p>
                    </div>
                </section>

                <!-- 分析结果 -->
                <section class="panel result-panel" id="result-panel" style="display: none;">
                    <h3>📊 分析结果</h3>
                    
                    <!-- 总体评分 -->
                    <div class="score-card" id="score-card">
                        <div class="score-circle">
                            <span class="score-value" id="total-score">--</span>
                            <span class="score-label">分</span>
                        </div>
                        <div class="grade-badge" id="grade-badge">-</div>
                    </div>
                    
                    <p class="summary" id="result-summary"></p>

                    <!-- 雷达图 -->
                    <div class="radar-chart-container">
                        <div id="radar-chart"></div>
                    </div>

                    <!-- 分类评分 -->
                    <div class="category-scores" id="category-scores">
                        <!-- 动态生成 -->
                    </div>

                    <!-- 改进建议 -->
                    <div class="suggestions" id="suggestions">
                        <h4>💡 改进建议</h4>
                        <ul id="suggestion-list"></ul>
                    </div>
                </section>

                <!-- POI 分类筛选 -->
                <section class="panel" id="poi-filter-panel">
                    <h3>🔍 POI筛选</h3>
                    <div class="poi-filter-controls">
                        <label class="filter-checkbox">
                            <input type="checkbox" id="filter-all" checked>
                            <span class="checkmark"></span>
                            <span>全选/取消</span>
                        </label>
                    </div>
                    <div class="poi-filter-list" id="poi-filter-list">
                        <label class="filter-checkbox" data-category="medical">
                            <input type="checkbox" checked>
                            <span class="checkmark" style="border-color: #e74c3c;"></span>
                            <span>🏥 医疗卫生</span>
                        </label>
                        <label class="filter-checkbox" data-category="education">
                            <input type="checkbox" checked>
                            <span class="checkmark" style="border-color: #3498db;"></span>
                            <span>🏫 教育设施</span>
                        </label>
                        <label class="filter-checkbox" data-category="elderly">
                            <input type="checkbox" checked>
                            <span class="checkmark" style="border-color: #e67e22;"></span>
                            <span>👴 养老服务</span>
                        </label>
                        <label class="filter-checkbox" data-category="commerce">
                            <input type="checkbox" checked>
                            <span class="checkmark" style="border-color: #f39c12;"></span>
                            <span>🛒 商业服务</span>
                        </label>
                        <label class="filter-checkbox" data-category="culture">
                            <input type="checkbox" checked>
                            <span class="checkmark" style="border-color: #27ae60;"></span>
                            <span>🎭 文化体育</span>
                        </label>
                        <label class="filter-checkbox" data-category="public">
                            <input type="checkbox" checked>
                            <span class="checkmark" style="border-color: #9b59b6;"></span>
                            <span>🏛️ 公共管理</span>
                        </label>
                        <label class="filter-checkbox" data-category="transport">
                            <input type="checkbox" checked>
                            <span class="checkmark" style="border-color: #1abc9c;"></span>
                            <span>🚌 交通设施</span>
                        </label>
                        <label class="filter-checkbox" data-category="child">
                            <input type="checkbox" checked>
                            <span class="checkmark" style="border-color: #ff69b4;"></span>
                            <span>👶 托幼托育</span>
                        </label>
                    </div>
                </section>

                <!-- 步行速度配置 -->
                <section class="panel" id="speed-config-panel">
                    <h3>🚶 步行速度</h3>
                    <div class="speed-presets">
                        <button class="speed-preset" data-speed="3.5" title="适合老人、儿童">🧓 慢速</button>
                        <button class="speed-preset active" data-speed="5.0" title="正常步行速度">🚶 正常</button>
                        <button class="speed-preset" data-speed="6.0" title="快步行走">🏃 快速</button>
                    </div>
                    <div class="speed-custom">
                        <label for="walk-speed">自定义速度：</label>
                        <div class="speed-input-group">
                            <input type="range" id="walk-speed" min="3.0" max="7.0" step="0.1" value="5.0">
                            <span class="speed-value" id="speed-display">5.0</span>
                            <span class="speed-unit">km/h</span>
                        </div>
                    </div>
                    <p class="speed-hint">
                        当前速度下，15分钟可步行 <strong id="walk-distance">1250</strong> 米
                    </p>
                </section>

                <!-- 图例 -->
                <section class="panel">
                    <h3>🎨 图例</h3>
                    <div class="legend">
                        <div class="legend-item">
                            <span class="legend-color" style="background: rgba(46, 204, 113, 0.4);"></span>
                            <span>5分钟步行圈</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background: rgba(52, 152, 219, 0.4);"></span>
                            <span>10分钟步行圈</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background: rgba(155, 89, 182, 0.4);"></span>
                            <span>15分钟步行圈</span>
                        </div>
                    </div>
                </section>
            </div>

            <footer class="sidebar-footer">
                <p>© 2026 15分钟生活圈项目</p>
                <p>基于 OpenStreetMap 数据</p>
            </footer>
        </aside>

        <!-- 地图容器 -->
        <main class="map-container">
            <div id="map"></div>
            
            <!-- 加载指示器 -->
            <div class="loading-overlay" id="loading" style="display: none;">
                <div class="spinner"></div>
                <p>正在分析...</p>
            </div>
        </main>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <!-- ECharts 雷达图 -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    
    <script src="/static/js/app.js"></script>
</body>
</html>
